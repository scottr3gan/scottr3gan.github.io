/*! Titan Tools (Huffington Post - v2.1.1) - Begin */
!function(a,b){function c(a){return"[object Array]"===Object.prototype.toString.call(a)}function d(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function e(a,c){return b.getElementById(a)||b.createElement(c||"div")}function f(a){var b=a.match(/(?:\d+x\d+_?|int)+/i),c=a.match(/pos-?(\d+)/i),d=[];return q(),d.push(B.adSite,C.ctype,C.cat,C.cat1,c?c[1]:null,b?b[0]:null,A.sysEnv),d.join("|")}function g(a){var b=0;if(0===a.length)return b;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);b=(b<<5)-b+d,b&=b}return b}function h(a){M&&"true"==M.titanLog&&console.error("TITAN: "+a),i("e:"+a)}function i(a){logHolder.push(a),checkTools()}function j(){titan.dataLayerValidate=w,titan.checkAdSlots=v,k(),titan.toolsRebuild=function(){k()},titan.toolsVersion="v2.1.1"}function k(){M&&"true"==M.titanDebug&&(titan.displayLogs=u,titan.showUniqueRef=x),M&&"true"==M.titanRegistry&&(titan.getAdDetails=l)}function l(){var a,b,c=titan.getReturnedAds(),d="",e="warn",f="No ads on this page";for(a in c)e="good",f="Returned Ads",b=c[a],d+="<b>"+a+"</b>\n",b.isEmpty?d+="No ad returned from server\n":b.isEmpty||b.lineItem?(d+='Line ID: <a href="https://www.google.com/dfp/6411#delivery/LineItemDetail/lineItemId='+b.lineItem+'" target="_blank">'+b.lineItem+"</a>\n",d+='Creative ID: <a href="https://www.google.com/dfp/6411#delivery/CreativeDetail/creativeId='+b.creative+'" target="_blank">'+b.creative+"</a>\n"):d+="Ad Exchange - No details available\n";p(d,e,f),titan.consoleState&&(titan.consoleState.name="adDetails")}function m(){var a=K.host,b=a.match(/smh|theage|brisbanetimes|watoday|canberraties/)&&"/"==K.pathname;return b?K.protocol+"//"+a+":8080":K.href}function n(){var a=";",b="";return(D?D+a:b)+(E?E+a:b)+(F?F+a:b)+(G?G+a:b)}function o(){q();var b=a.h||[],d="/public/action/pingServerAction?i=",e=[],f=m(),h=n(),i=0;if(c(b)&&"CQ"===A.generator){for(;i<b.length;i++)e.push(g(f+":"+b[i])),e.push(g(h+b[i]));(new Image).src=d+e.join(",")}}function p(a,c,d){function f(a){var c="touchend"==a.type,d=b.getElementById("tt-wrap");(c||!m)&&(d.parentNode.removeChild(d),m=c),delete titan.consoleState}titan.consoleState=titan.consoleState||{},titan.consoleState.active=!0,scrollTo(0,0);var g=e("tt-styles","style"),h=e("tt-wrap"),i=e("tt-close"),j=e("tt-warn","pre"),k=e("tt-display","pre"),l="#tt-wrap{position:absolute;top:0;left:0;width:100%;z-index:1000000000;background-color:#DDD;min-height:30px}@media (min-width:992px){#tt-wrap{left:25%;width:50%;overflow:hidden;border:1px #999 solid}}#tt-wrap pre{font:12pt monospace;color:#000;overflow:auto;white-space:pre;word-wrap:normal;margin:0;padding:5px}#tt-warn{display:none}.good #tt-warn{display:block;background-color:#090;color:#FFF}.warn #tt-warn{display:block;background-color:#990;color:#FFF}.err #tt-warn{display:block;background-color:#900;color:#FFF}#tt-close{position:absolute;width:30px;height:30px;right:0;top:0;background-image:url(http://ads.fairfax.com.au/TechOps/images/CloseBtn.png);background-size:30px 60px}\n",m=!1;h.className=c?c:"",j.innerHTML=d,k.innerHTML=a,g.type="text/css",g.id="tt-styles",g.styleSheet?g.styleSheet.cssText=l:g.innerHTML=l,h.id||(h.id="tt-wrap",i.id="tt-close",i.onclick=f,i.ontouchend=f,j.id="tt-warn",k.id="tt-display",h.appendChild(i),h.appendChild(j),h.appendChild(k),b.body.appendChild(g),b.body.appendChild(h))}function q(){y=a.digitalData||{},z=y.page||{},A=z.pageInfo||{},B=y.titan||{},C=B.adKeyValues||{},D=A.sysEnv,E=B.adSite,F=B.adZone,G=C.ctype,H=B.adSlots||[],I=B.adSlotsAdditional||[],J=H.concat(I)}function r(){return a.titan=a.titan||{},titan.toolsInitialised?void h("Attempt to load titan tools failed as it has already initialised"):(titan.toolsInitialised=!0,j(),void s())}function s(){L.match(/datalayervalidate=true/i)?w():L.match(/checkadspots=true/i)?v():L.match(/displaylogs=true/i)?t(u):L.match(/getaddetails=true/i)?t(l):L.match(/showuniqueref=true/i)?t(x):"true"==M.titanClear&&(M.removeItem("titanDebug"),M.removeItem("titanRegistry"),M.removeItem("titanClear")),setTimeout(o,3e3)}function t(a){("true"!=M.titanDebug||"true"!=M.titanRegistry)&&(M.titanDebug="true",M.titanRegistry="true",M.titanClear="true",titan.rebuild()),a()}function u(){for(var a,b,c=titan.logHolder||[],d=0,e="",f="good",g="Ok";d<c.length;d++)a=c[d],b=a.match(/^e:/),e&&(e+="\n"),e+=b?'<span style="color:#F00;">'+a.substr(2)+"</span>":a,b&&(g="Errors Logged",f="err");p(e,f,g),titan.consoleState&&(titan.consoleState.name="log")}function v(){q();var a,c,d=b.querySelectorAll("div[id^=adspot]"),e={},f="",g="err",h="DataLayer Discrepancies Found";for(c=d.length-1;c>=0;c--)a=d[c],a.innerHTML.match(/onditional ?(Ad|Titan)/)||(e[a.id]="On page, not in DataLayer");for(c=J.length-1;c>=0;c--)a=J[c],e[a]?e[a].match(/^In DataLayer/)?e[a]="Duplicate in DataLayer, not on page":e[a].match(/Both/)?e[a]="Duplicate value in DataLayer":e[a].match(/On page/)&&(e[a]="Both"):e[a]="In DataLayer, not on page";a=e["adspot-interstitial"],e["adspot-interstitial"]=a&&!a.match(/not on page/)?"Both":"Interstitial slot missing from page";for(a in e)e.hasOwnProperty(a)&&"Both"!==e[a]&&(f+=a+": "+e[a]+"\n",g="err");""===f&&(f="No DataLayer/page discrepancies",g="good",h="Ok"),f=f.replace(/\n$/,""),p(f,g,h)}function w(){q();var a="mobile"==D,b="",c=[],e=0,f="err";if(d(y))b+="DataLayer is not defined\n";else if(d(B))b+="Titan section is not defined\n";else if(E||(b+="adSite is not defined\n"),F?F.match(/\/$/)&&(b+='adZone cannot end in "/"\n'):b+="adZone is not defined\n",d(C)&&(b+="adKeyValues are not defined\n"),G||(b+="ctype is not defined\n"),C.cat||(b+="cat is not defined\n"),0===J.length)b+="adSlots are missing";else for(c=H.concat(I);e<c.length;e++)c[e].match(/^adspot-((\d+x\d+_?)+-pos-?\d$|int)/)||(b+="Invalid adslot format: "+c[e]+"\n");b||(f="good",b="Ok"),Array.prototype&&delete Array.prototype.toJSON,p(JSON.stringify(y,null,a?1:4),f,b)}function x(){var a,b,c=titan.displayedSlots,d="",e="warn",h="No ads on this page";for(a in c)e="good",h="Unique Ad IDs",d+="<b>"+a+"</b>\n",b=f(a),d+="ID: "+b+"\n",d+="Hash: "+g(b)+"\n";p(d,e,h),titan.consoleState&&(titan.consoleState.name="uniqueRef")}var y,z,A,B,C,D,E,F,G,H,I,J,K=a.location,L=K.search,M=a.localStorage;r()}(window,document);
/*! Titan Tools (Huffington Post - v2.1.1) - End */
